<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Discussion History Test</title>
    <style>
        body { font-family: 'Pretendard', sans-serif; padding: 20px; background: #f5f5f5; }
        .section { background: white; padding: 20px; margin: 20px 0; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .section-title { font-size: 20px; font-weight: bold; margin-bottom: 15px; color: #667eea; }
    </style>
</head>
<body>
    <h1>Discussion History Display Test</h1>
    
    <div class="section">
        <div class="section-title">í…ŒìŠ¤íŠ¸ ë°ì´í„° ì‹œë®¬ë ˆì´ì…˜</div>
        <button onclick="testDisplay()">ê²°ê³¼ ë Œë”ë§ í…ŒìŠ¤íŠ¸</button>
    </div>
    
    <div id="resultContent"></div>
    
    <script>
        // í…ŒìŠ¤íŠ¸ìš© mock ë°ì´í„°
        const mockData = {
            ai_summary: "AI ì¢…í•© ë¶„ì„ ìš”ì•½ì…ë‹ˆë‹¤.",
            discussion_history: [
                "[ì¬ë¬´ ì „ë¬¸ê°€] ì‚¼ì„±ì „ìëŠ” ê²¬ê³ í•œ ì¬ë¬´êµ¬ì¡°ë¥¼ ë³´ìœ í•˜ê³  ìˆìœ¼ë©°, ì˜ì—…ì´ìµë¥ ì´ ì—…ê³„ í‰ê· ì„ ìƒíšŒí•©ë‹ˆë‹¤. ROE 12%ë¡œ ì£¼ì£¼ê°€ì¹˜ ì°½ì¶œì´ ìš°ìˆ˜í•©ë‹ˆë‹¤.",
                "[ê¸°ìˆ  ì „ë¬¸ê°€] RSI ì§€í‘œê°€ ì¤‘ë¦½ê¶Œì— ìœ„ì¹˜í•˜ê³  ìˆìœ¼ë©°, 20ì¼ ì´ë™í‰ê· ì„ ì´ ìƒí–¥ ëŒíŒŒ ì‹œë„ ì¤‘ì…ë‹ˆë‹¤. ê±°ë˜ëŸ‰ ì¦ê°€ íŒ¨í„´ì´ ê¸ì •ì ì…ë‹ˆë‹¤.",
                "[ë‰´ìŠ¤ ì „ë¬¸ê°€] ìµœê·¼ AI ë°˜ë„ì²´ ìˆ˜ìš” ì¦ê°€ì™€ ê´€ë ¨ëœ ê¸ì •ì  ë‰´ìŠ¤ê°€ ë‹¤ìˆ˜ ë³´ë„ë˜ì—ˆìŠµë‹ˆë‹¤. ê²½ìŸì‚¬ ëŒ€ë¹„ ê¸°ìˆ  ìš°ìœ„ë¥¼ ìœ ì§€í•˜ê³  ìˆë‹¤ëŠ” í‰ê°€ì…ë‹ˆë‹¤."
            ],
            portfolio_allocation: [],
            performance_metrics: {}
        };
        
        function testDisplay() {
            let html = `
                <!-- 1. AI ì¢…í•© ìš”ì•½ -->
                <div class="section">
                    <div class="section-title">ğŸ¯ AI ì¢…í•© ë¸Œë¦¬í•‘</div>
                    <div style="background: #f8f9fa; padding: 15px; border-left: 4px solid #667eea;">
                        ${mockData.ai_summary}
                    </div>
                </div>
            `;
            
            // â­ ë©€í‹°ì—ì´ì „íŠ¸ ì „ë¬¸ê°€ ì˜ê²¬ í‘œì‹œ
            if (mockData.discussion_history && mockData.discussion_history.length > 0) {
                html += `
                <div class="section">
                    <div class="section-title">ğŸ‘¥ ì „ë¬¸ê°€ ë¶„ì„ ì˜ê²¬</div>
                    <div style="display: grid; gap: 15px;">
                `;
                
                mockData.discussion_history.forEach((opinion, idx) => {
                    // ì „ë¬¸ê°€ íƒ€ì… ê°ì§€
                    let expertType = 'ì „ë¬¸ê°€';
                    let expertIcon = 'ğŸ’¼';
                    let expertColor = '#667eea';
                    
                    if (opinion.includes('[ì¬ë¬´ ì „ë¬¸ê°€]') || opinion.includes('Financial Agent')) {
                        expertType = 'ì¬ë¬´ ì „ë¬¸ê°€';
                        expertIcon = 'ğŸ’°';
                        expertColor = '#28a745';
                    } else if (opinion.includes('[ê¸°ìˆ  ì „ë¬¸ê°€]') || opinion.includes('Technical Agent')) {
                        expertType = 'ê¸°ìˆ  ì „ë¬¸ê°€';
                        expertIcon = 'ğŸ“Š';
                        expertColor = '#007bff';
                    } else if (opinion.includes('[ë‰´ìŠ¤ ì „ë¬¸ê°€]') || opinion.includes('News Agent')) {
                        expertType = 'ë‰´ìŠ¤ ì „ë¬¸ê°€';
                        expertIcon = 'ğŸ“°';
                        expertColor = '#dc3545';
                    }
                    
                    // íƒœê·¸ ì œê±°
                    let cleanOpinion = opinion
                        .replace(/\[ì¬ë¬´ ì „ë¬¸ê°€\]\s*/g, '')
                        .replace(/\[ê¸°ìˆ  ì „ë¬¸ê°€\]\s*/g, '')
                        .replace(/\[ë‰´ìŠ¤ ì „ë¬¸ê°€\]\s*/g, '')
                        .replace(/Financial Agent:\s*/gi, '')
                        .replace(/Technical Agent:\s*/gi, '')
                        .replace(/News Agent:\s*/gi, '')
                        .trim();
                    
                    html += `
                        <div style="
                            background: linear-gradient(135deg, ${expertColor}15 0%, ${expertColor}05 100%);
                            border-left: 4px solid ${expertColor};
                            padding: 15px;
                            border-radius: 8px;
                            margin-bottom: 10px;
                        ">
                            <div style="
                                display: flex;
                                align-items: center;
                                gap: 10px;
                                margin-bottom: 10px;
                                font-weight: 600;
                                color: ${expertColor};
                                font-size: 14px;
                            ">
                                <span style="font-size: 20px;">${expertIcon}</span>
                                <span>${expertType}</span>
                            </div>
                            <div style="
                                line-height: 1.6;
                                color: #333;
                                font-size: 13px;
                                white-space: pre-wrap;
                            ">${cleanOpinion}</div>
                        </div>
                    `;
                });
                
                html += `
                    </div>
                </div>
                `;
            }
            
            document.getElementById('resultContent').innerHTML = html;
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ í…ŒìŠ¤íŠ¸
        window.onload = function() {
            testDisplay();
        };
    </script>
</body>
</html>
